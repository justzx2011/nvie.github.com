
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en">
	<head>
		<meta charset="utf-8"/>
		<title>Pin Your Packages &raquo; nvie.com</title>
		<link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>
		<link rel="stylesheet" type="text/css" href="/css/style.css" />
		<link rel="stylesheet" type="text/css" href="/css/syntax.css" />
		<link rel="stylesheet" type="text/css" href="/css/fontface.css" />
		<meta name="viewport" content="width=700, user-scalable=yes, maximum-scale=1.5" />
		<link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="/css/mobile.css" type="text/css" /> 
		<link rel="stylesheet" media="only screen and (max-device-width: 1024px)" href="/css/mobile.css" type="text/css" /> 
		<link rel="stylesheet" media="print" type="text/css" href="/css/print.css" />
		<script type="text/javascript" src="/js/jquery.min.js"></script>
		<script type="text/javascript" src="/js/relatize_date.js"></script>
		
		<script type="text/javascript">
  			var disqus_developer = 1;
		</script>
  		
		<script type="text/javascript" src="/js/site.js"></script>
		<script type="text/javascript" src="/js/defeatthefout.js"></script>
		<meta name="generator" content="nanoc"/>
		<meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1"/>
		<link href="/img/favicon.ico" rel="shortcut icon" type="image/x-icon" /> 
		<link href="/img/icon.png" rel="apple-touch-icon" /> 
		<link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/nvie" />

        <script type="text/javascript" src="//use.typekit.net/nge1fhs.js"></script>
        <script type="text/javascript">try{Typekit.load();}catch(e){}</script></script></script>

		
		

        <script type="text/javascript">
        /* <![CDATA[ */
            (function() {
                var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
                s.type = 'text/javascript';
                s.async = true;
                s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
                t.parentNode.insertBefore(s, t);
            })();
        /* ]]> */</script>
	</head>
	<body>
		<div id="header">
			<h1><a href="/"><span id="nvie">nvie</span><span id="dot">.</span><span id="ext">com</span></a></h1>
			<ul>
                <li id="home" ><a href="/">Home</a></li>
                <li id="posts"  class='current'><a href="/posts/">Posts</a></li>
                
                <li id="about" ><a href="/about/">About me</a></li>
			</ul>
        </div>
		<div id="actionbox" style="display: none">
            <div id="rss"><a href="http://feeds.feedburner.com/nvie"><img src="/img/rss.png" alt="Subscribe" title="Subscribe" width="16" height="16" /></a></div>
            <div id="tweet"><a href="http://twitter.com/share?url=http://nvie.com/posts/pin-your-packages/&via=nvie&text=Pin%20Your%20Packages"><img src='/img/twitter.png' width="16" height="16" alt="Tweet this!" title="Tweet this!" /></a></div>

            <!-- Ad -->
            <div id="influads_block" class="influads_block"> </div>
            <script type="text/javascript">(function(){ var acc =   "acc_535d576_pub";var st ="css";var or= "130";var e=document.getElementsByTagName("script")[0];var d=document.createElement("script");d.src=('https:' == document.location.protocol ?'https://' : 'http://') +"engine.influads.com/show/"+or+"/"+st+"/"+acc;d.type="text/javascript"; d.async=true; d.defer=true; e.parentNode.insertBefore(d,e);})();</script>
		</div>
		<div id="main">
			<div id="post">
    
<h1>Pin Your Packages</h1>

<p id="permalink" class="print-only">http://nvie.com/posts/pin-your-packages/</p>
<p class="no-print created_at dateline">Published: <span class="reldate">September 10, 2012</span></p><p class="print-only created_at dateline">Published: <span>September 10, 2012</span></p>
<p>In order to build your Python application and its dependencies for production,
you want to make sure that your builds are predictable and deterministic.
Therefore, <b>always pin your dependencies</b>.</p>
<p>Don&#8217;t ever use these in <code>requirements.txt</code>:</p>
<ul>
	<li><code>lxml</code></li>
	<li><code>lxml&gt;=2.2.0</code></li>
	<li><code>lxml&gt;=2.2.0,&lt;2.3.0</code></li>
</ul>
<p>Instead, pin them:</p>
<ul>
	<li><code>lxml==2.3.4</code></li>
</ul>
<h3>Why not use the first three ways?</h3>
<p>Your builds can&#8217;t ever be deterministic.</p>
<p>It&#8217;s unpredictable what version will be installed in your environments when
you run <code>pip install</code>&#8212;it depends on what&#8217;s already installed, and on what
version is the best match on PyPI at the moment you run it.</p>
<p>Each team member probably has a few environments for development and testing,
and then there&#8217;s the production environment.  Depending on the time of
installation, each of these environments can have a different version
installed.</p>
<p>Additionally, the problem can&#8217;t be fixed by rerunning <code>pip install</code>.  There
simply is no way to predict what versions will land in what environment, even
if you rebuild the whole environment from scratch each time.</p>
<p>It&#8217;s waiting for bad things to happen in production.</p>
<h3>Pin for Predictability</h3>
<p>There is only one way of making your builds deterministic.  You should pin
<em>every</em> single package dependency.  However, there is one disadvantage with
this, and it&#8217;s often used as the excuse not to do it&#8212;you&#8217;ll miss out on the
bugfix releases.</p>
<p>Well, yes, you will.  But think of it.  It&#8217;s impossible to distinguish between
a new release that fixes bugs, or a new release that introduced bugs.  The
former will improve your code, while the latter may break it.  You are leaving
it up to coincidence now.  There is only one way to retake control:</p>
<blockquote>
<p><b>Always pin your dependencies.</b></p>
</blockquote>
<p>This does imply that you need to look at every dependency upgrade in
a development environment first, and allow each explicitly.  This may be
tedious, but not when you use the right tooling.</p>
<h3>Meet pip-refresh</h3>
<p>Meet <a href="https://github.com/nvie/pip-refresh"><code>pip-refresh</code></a>.  It&#8217;s a tool I wrote
for assisting in this process.  It will check for available package updates
for all packages installed in your environment:</p>
$ pip-refresh
show
example
outout
here
<p>I like to run this script every monday, during a team standup meeting, to see
whether new versions are available and decide with the team which ones to
upgrade.  On many occassions, you can just upgrade them all and if things
start to fail, revert those.  (Don&#8217;t forget to make note of the failure.)</p>
<p><!--
Armin "warned
us":http://twitter.com/mitsuhiko/status/240454487490326528 about it.  Heroku
advises it as a "best
practice":https://devcenter.heroku.com/articles/python-pip#best-practices.
And Python deployment talks "tell you the
same":http://carljm.github.com/tamingdeps/#11.
--></p>
</div>



		</div>
		<div id="footer">
            <p>Vincent Driessen is an independent Python and iOS software
            engineer and consultant from the Netherlands. You may
            <a href="http://www.3rdcloud.com">hire him</a>.
			</p>
		</div>

		
		
	</body>
</html>
